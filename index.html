<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç§å¯†ç•™è¨€æ¿ - ç”¨æˆ·ç™»å½•</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="login-container">
        <div class="login-box">
            <h1>ğŸ” ç§å¯†ç•™è¨€æ¿</h1>
            <p class="subtitle">è¯·è¾“å…¥æ‚¨çš„è®¿é—®å¯†é’¥</p>
            
            <div class="input-group">
                <input type="text" id="secret-key" placeholder="è¾“å…¥æ‚¨çš„ä¸“å±å¯†é’¥..." autocomplete="off">
                <button id="login-btn" class="login-button">è¿›å…¥å¯¹è¯</button>
            </div>
            
            <div class="admin-link">
                <a href="admin.html">ç®¡ç†å‘˜å…¥å£</a>
            </div>
            
            <div class="features">
                <h3>åŠŸèƒ½ç‰¹ç‚¹ï¼š</h3>
                <ul>
                    <li>ğŸ”’ ç«¯åˆ°ç«¯åŠ å¯†å¯¹è¯</li>
                    <li>ğŸ’¬ æ”¯æŒå®Œæ•´æ ¼å¼æ–‡æœ¬</li>
                    <li>ğŸ”„ å®æ—¶æ¶ˆæ¯åŒæ­¥</li>
                    <li>ğŸ“± å¤šè®¾å¤‡è®¿é—®</li>
                </ul>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        document.getElementById('login-btn').addEventListener('click', userLogin);
        document.getElementById('secret-key').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') userLogin();
        });

        async function userLogin() {
            const secretKey = document.getElementById('secret-key').value.trim();
            if (!secretKey) {
                showAlert('è¯·è¾“å…¥è®¿é—®å¯†é’¥', 'error');
                return;
            }

            showAlert('éªŒè¯å¯†é’¥ä¸­...', 'info');
            
            try {
                // æŸ¥æ‰¾åŒ…å«è¯¥å¯†é’¥çš„Issue
                const issue = await findIssueBySecretKey(secretKey);
                if (issue) {
                    // è·³è½¬åˆ°å¯¹è¯ç•Œé¢ï¼Œä¼ é€’Issueä¿¡æ¯
                    localStorage.setItem('currentChat', JSON.stringify({
                        issueNumber: issue.number,
                        secretKey: secretKey,
                        userType: 'user'
                    }));
                    window.location.href = 'chat.html';
                } else {
                    showAlert('å¯†é’¥æ— æ•ˆæˆ–ä¸å­˜åœ¨', 'error');
                }
            } catch (error) {
                console.error('ç™»å½•é”™è¯¯:', error);
                showAlert('éªŒè¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥', 'error');
            }
        }
    </script>
</body>
</html>
